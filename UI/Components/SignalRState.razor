@inject SignalRClientState SignalRClientState
@implements IDisposable

@if (SignalRClientState.State != SignalRClientState.SignalRStateEnum.Initialized)
{
    <div class="mt-3 ms-3">
        <HxSpinner /> @(SignalRClientState.State.ToString())
    </div>
}

@code {
    protected override async Task OnInitializedAsync()
    {
        SignalRClientState.OnChange += OnChangeHandler;
        
        await SignalRClientState.Initialize();
    }

    private void OnChangeHandler(object? _, EventArgs args)
    {
        StateHasChanged();
    }

    void IDisposable.Dispose()
    {
        if (SignalRClientState?.OnChange != null)
        {
#pragma warning disable CS8601
            SignalRClientState.OnChange -= OnChangeHandler;
#pragma warning restore CS8601
        }
    }
}